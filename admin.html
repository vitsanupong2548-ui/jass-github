<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { 'sans': ['"Prompt"', 'sans-serif'] },
                    colors: { 
                        brandBlue: '#0c32f9',
                        brandYellow: '#ffc107',
                        brandGreen: '#10a349',
                        brandGrey: '#b2b2b2'
                    }
                }
            }
        }
    </script>
    <style>
        .section-header { display: flex; align-items: center; font-size: 1.25rem; font-weight: 700; color: #000; margin-top: 2rem; margin-bottom: 1rem; }
        .section-header::after { content: ""; flex: 1; height: 1px; background-color: #d1d5db; margin-left: 1rem; }
        input[type="date"]::-webkit-calendar-picker-indicator, input[type="time"]::-webkit-calendar-picker-indicator { cursor: pointer; opacity: 0.6; }
        input[type="date"]::-webkit-calendar-picker-indicator:hover, input[type="time"]::-webkit-calendar-picker-indicator:hover { opacity: 1; }
    </style>
</head>
<body class="bg-white text-black font-sans flex h-screen overflow-hidden">

    <aside class="w-64 border-r border-gray-300 flex-shrink-0 h-full overflow-y-auto bg-white flex flex-col">
        <div class="p-6">
            <h1 class="text-xl font-bold mb-4">Admin</h1>
        </div>
        <nav class="flex flex-col flex-1 pb-10">
            <div id="nav-festival-bg" class="bg-brandBlue transition-colors">
                <a href="#" onclick="switchMainView('festival')" id="nav-festival-text" class="text-white font-bold py-3 px-6 block hover:opacity-80 transition">Festival & Event</a>
            </div>
            <div id="event-list" class="flex flex-col pl-8 py-2 text-sm space-y-2 text-gray-700 bg-gray-50 border-b border-gray-200 hidden"></div>
            
            <div id="nav-musician-bg" class="transition-colors mt-2">
                <a href="#" onclick="switchMainView('musician')" id="nav-musician-text" class="font-bold text-black py-3 px-6 block hover:opacity-80 transition">Musician Network</a>
            </div>
            <div id="musician-sub-nav" class="flex flex-col text-sm space-y-1 text-gray-700 bg-gray-50 pb-2 hidden">
                <div class="px-6 py-1 font-semibold text-gray-500 text-xs mt-2">Artist Library</div>
                <div id="artist-list" class="flex flex-col pl-8 space-y-2 hidden"></div>
                <div class="px-6 py-1 font-semibold text-gray-500 text-xs mt-2">Jazz Network</div>
                <div id="jazz-list" class="flex flex-col pl-8 space-y-2 hidden"></div>
            </div>
            
            <div id="nav-courses-bg" class="transition-colors mt-2">
                <a href="#" onclick="switchMainView('courses')" id="nav-courses-text" class="font-bold text-black py-3 px-6 block hover:opacity-80 transition">Courses Library</a>
            </div>
            <div id="courses-list" class="flex flex-col pl-8 py-2 text-sm space-y-2 text-gray-700 bg-gray-50 border-b border-gray-200 hidden"></div>

            <div id="nav-bigband-bg" class="transition-colors mt-2">
                <a href="#" onclick="switchMainView('bigband')" id="nav-bigband-text" class="font-bold text-black py-3 px-6 block hover:opacity-80 transition">CMBigband</a>
            </div>
            <div id="bigband-list" class="flex flex-col pl-8 py-2 text-sm space-y-2 text-gray-700 bg-gray-50 border-b border-gray-200 hidden"></div>

            <a href="#" class="font-bold text-black hover:text-brandBlue py-3 px-6 mt-2">Forum Q&A</a>
            <a href="#" class="font-bold text-black hover:text-brandBlue py-3 px-6">Store & Merch</a>
        </nav>
    </aside>

    <main class="flex-1 h-full overflow-y-auto relative bg-white">
        
        <div id="view-festival" class="block">
            <header class="bg-brandBlue text-white px-8 py-6 sticky top-0 z-10 flex justify-between items-center shadow-md">
                <h2 class="text-3xl font-bold" id="header-title-festival">Create New Event</h2>
                <button onclick="createNewEvent()" class="bg-white text-brandBlue px-6 py-2 rounded-full font-bold hover:bg-gray-100 transition shadow">+ Add New Event</button>
            </header>
            <div class="p-8 max-w-4xl">
                <div class="bg-blue-50 text-blue-800 p-4 rounded-lg mb-6 text-sm">ส่วนของฟอร์ม Festival & Event จะอยู่ตรงนี้ (ใช้โค้ดจากเวอร์ชันก่อนหน้ามาแปะได้เลยครับ)</div>
                <input type="text" id="input-title" placeholder="Event Title (ชื่อกิจกรรม)" class="w-full border border-gray-400 rounded-full px-4 py-2 mb-4 font-bold text-lg outline-none focus:border-brandBlue">
                <div class="mt-8 pt-6 border-t border-gray-300 flex justify-between items-center">
                    <button id="btn-delete-event" onclick="deleteEvent()" class="hidden text-red-500 border border-red-500 px-6 py-2 rounded-full font-bold hover:bg-red-500 hover:text-white transition shadow">Delete Event</button>
                    <button onclick="saveEvent()" class="bg-brandBlue text-white px-10 py-3 rounded-full font-bold text-lg hover:bg-blue-800 transition shadow-lg ml-auto">Save Event</button>
                </div>
            </div>
        </div>

        <div id="view-musician" class="hidden">
            <header class="bg-brandYellow text-black px-8 py-6 sticky top-0 z-10 flex justify-between items-center shadow-md">
                <h2 class="text-3xl font-bold" id="header-title-musician">Create New Profile</h2>
                <button onclick="createNewMusician()" class="bg-black text-brandYellow px-6 py-2 rounded-full font-bold hover:bg-gray-800 transition shadow">+ Add New Profile</button>
            </header>
            <div class="p-8 max-w-4xl">
                <div class="bg-yellow-50 text-yellow-800 p-4 rounded-lg mb-6 text-sm">ส่วนของฟอร์ม Musician Network จะอยู่ตรงนี้ (ใช้โค้ดจากเวอร์ชันก่อนหน้ามาแปะได้เลยครับ)</div>
                <input type="text" id="input-musician-title" placeholder="Band Title" class="w-full border border-gray-400 rounded-full px-4 py-2 mb-4 font-bold text-lg outline-none focus:border-brandYellow">
                <div class="mt-8 pt-6 border-t border-gray-300 flex justify-between items-center">
                    <button id="btn-delete-musician" onclick="deleteMusician()" class="hidden text-red-500 border border-red-500 px-6 py-2 rounded-full font-bold hover:bg-red-500 hover:text-white transition shadow">Delete Profile</button>
                    <button onclick="saveMusician()" class="bg-black text-brandYellow px-10 py-3 rounded-full font-bold text-lg hover:bg-gray-800 transition shadow-lg ml-auto">Save Profile</button>
                </div>
            </div>
        </div>

        <div id="view-courses" class="hidden">
            <header class="bg-brandGreen text-white px-8 py-6 sticky top-0 z-10 flex justify-between items-center shadow-md">
                <h2 class="text-3xl font-bold" id="header-title-courses">Courses Library</h2>
                <button onclick="createNewCourse()" class="bg-white text-brandGreen px-6 py-2 rounded-full font-bold hover:bg-gray-100 transition shadow">+ Add New Course</button>
            </header>

            <div class="p-8 max-w-4xl">
                <div class="mb-6">
                    <label class="bg-gray-200 h-48 w-full flex items-center justify-center font-bold text-gray-600 cursor-pointer hover:bg-gray-300 transition relative overflow-hidden rounded-xl border-2 border-dashed border-gray-400">
                        <span id="text-course-banner">+ Add Banner</span>
                        <img id="preview-course-banner" class="absolute inset-0 w-full h-full object-cover hidden" src="">
                        <input type="file" accept="image/*" class="hidden" onchange="previewImage(event, 'preview-course-banner', 'text-course-banner')">
                    </label>
                </div>

                <div class="space-y-4 mb-8">
                    <input type="text" id="input-course-title" placeholder="Course Title" class="w-full border border-gray-400 rounded-full px-4 py-2 outline-none focus:border-brandGreen font-bold text-lg">
                    <input type="text" id="input-course-creator" placeholder="Creator" class="w-full border border-gray-400 rounded-full px-4 py-2 outline-none focus:border-brandGreen">
                    
                    <div class="mt-6 border border-gray-400 rounded-2xl p-4">
                        <div class="flex gap-3 mb-4 border-b border-gray-300 pb-4">
                            <button class="border border-gray-400 rounded-full px-4 py-1.5 text-xs font-bold hover:bg-gray-100 transition flex items-center gap-2">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h7"></path></svg> Add Text
                            </button>
                            <button class="border border-gray-400 rounded-full px-4 py-1.5 text-xs font-bold hover:bg-gray-100 transition flex items-center gap-2">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg> Add Image
                            </button>
                            <button class="border border-gray-400 rounded-full px-4 py-1.5 text-xs font-bold hover:bg-gray-100 transition flex items-center gap-2">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg> Add Video
                            </button>
                        </div>
                        <textarea id="input-course-details" placeholder="Details ...." rows="8" class="w-full outline-none focus:border-brandGreen resize-none text-sm"></textarea>
                    </div>
                </div>

                <div class="mt-12 pt-6 border-t border-gray-300 flex justify-between items-center">
                    <button id="btn-delete-course" onclick="deleteCourse()" class="hidden text-red-500 border border-red-500 px-6 py-2 rounded-full font-bold hover:bg-red-500 hover:text-white transition shadow">Delete Course</button>
                    <button onclick="saveCourse()" class="bg-brandGreen text-white px-10 py-3 rounded-full font-bold text-lg hover:bg-green-700 transition shadow-lg ml-auto">Save Course</button>
                </div>
            </div>
        </div>

        <div id="view-bigband" class="hidden">
            <header class="bg-brandGrey text-black px-8 py-6 sticky top-0 z-10 flex justify-between items-center shadow-md">
                <h2 class="text-3xl font-bold" id="header-title-bigband">CMBigband</h2>
                <button onclick="createNewBigband()" class="bg-black text-white px-6 py-2 rounded-full font-bold hover:bg-gray-800 transition shadow">+ Add Profile</button>
            </header>

            <div class="p-8 max-w-4xl">
                <div class="grid grid-cols-2 gap-4 mb-6">
                    <label class="bg-gray-200 h-40 flex items-center justify-center font-bold text-gray-600 cursor-pointer hover:bg-gray-300 transition relative overflow-hidden rounded-xl border-2 border-dashed border-gray-400">
                        <span id="text-bb-banner">+ Add Banner</span>
                        <img id="preview-bb-banner" class="absolute inset-0 w-full h-full object-cover hidden" src="">
                        <input type="file" accept="image/*" class="hidden" onchange="previewImage(event, 'preview-bb-banner', 'text-bb-banner')">
                    </label>
                    <label class="bg-gray-200 h-40 flex items-center justify-center font-bold text-gray-600 cursor-pointer hover:bg-gray-300 transition relative overflow-hidden rounded-xl border-2 border-dashed border-gray-400">
                        <span id="text-bb-profile">+ Add Profile</span>
                        <img id="preview-bb-profile" class="absolute inset-0 w-full h-full object-cover hidden" src="">
                        <input type="file" accept="image/*" class="hidden" onchange="previewImage(event, 'preview-bb-profile', 'text-bb-profile')">
                    </label>
                </div>

                <div class="space-y-4 mb-8">
                    <input type="text" id="input-bb-title" placeholder="Band Title" class="w-full border border-gray-400 rounded-full px-4 py-2 outline-none focus:border-black font-bold text-lg">
                    <input type="text" id="input-bb-genre" placeholder="Genre" class="w-full border border-gray-400 rounded-full px-4 py-2 outline-none focus:border-black">
                    
                    <div class="grid grid-cols-2 gap-4 mt-6">
                        <div class="flex items-center gap-2">
                            <div class="w-8 h-8 rounded-full bg-blue-600 flex items-center justify-center text-white flex-shrink-0"><svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24"><path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.469h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.469h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/></svg></div>
                            <input type="text" id="soc-bb-fb" class="w-full border border-gray-400 rounded-full px-3 py-1 outline-none text-sm focus:border-black">
                        </div>
                        <div class="flex items-center gap-2">
                            <div class="w-8 h-8 rounded-full bg-green-500 flex items-center justify-center text-white flex-shrink-0"><svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24"><path d="M12.031 0C5.385 0 0 5.385 0 12.031c0 2.653.863 5.14 2.378 7.182L.632 24l4.908-1.745c1.977 1.306 4.28 2.012 6.666 2.012 6.646 0 12.031-5.385 12.031-12.031S18.677 0 12.031 0zm4.587 17.207c-.207.585-1.189 1.12-1.637 1.157-.449.037-1.042.13-2.955-.662-2.315-.96-3.804-3.328-3.92-3.483-.116-.156-.937-1.246-.937-2.376 0-1.13.585-1.688.788-1.916.203-.228.444-.284.593-.284.148 0 .297 0 .428.006.136.006.315-.052.493.376.18.435.617 1.503.673 1.618.056.115.093.251.018.402-.074.151-.112.245-.223.375-.112.131-.238.283-.339.395-.112.113-.23.235-.1.459.13.224.58 1.054 1.332 1.734.97.882 1.782 1.154 2.007 1.267.225.113.355.094.486-.054.131-.149.563-.655.713-.881.149-.226.297-.188.503-.112.206.075 1.302.614 1.527.727.225.113.375.169.431.264.056.094.056.547-.151 1.132z"/></svg></div>
                            <input type="text" id="soc-bb-wa" class="w-full border border-gray-400 rounded-full px-3 py-1 outline-none text-sm focus:border-black">
                        </div>
                        <div class="flex items-center gap-2">
                            <div class="w-8 h-8 rounded-full bg-gradient-to-tr from-yellow-400 via-red-500 to-purple-500 flex items-center justify-center text-white flex-shrink-0"><svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4s1.791-4 4-4 4 1.79 4 4-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/></svg></div>
                            <input type="text" id="soc-bb-ig" class="w-full border border-gray-400 rounded-full px-3 py-1 outline-none text-sm focus:border-black">
                        </div>
                        <div class="flex items-center gap-2">
                            <div class="w-8 h-8 rounded-full bg-gray-600 flex items-center justify-center text-white flex-shrink-0"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9"/></svg></div>
                            <input type="text" id="soc-bb-web" class="w-full border border-gray-400 rounded-full px-3 py-1 outline-none text-sm focus:border-black">
                        </div>
                        <div class="flex items-center gap-2">
                            <div class="w-8 h-8 rounded-full bg-black flex items-center justify-center text-white flex-shrink-0"><svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24"><path d="M19.59 6.69a4.83 4.83 0 01-3.77-4.25V2h-3.45v13.67a2.89 2.89 0 01-5.2 1.74 2.89 2.89 0 012.31-4.64 2.93 2.93 0 01.88.13V9.4a6.84 6.84 0 00-1-.05A6.33 6.33 0 005 20.1a6.34 6.34 0 0010.86-4.43v-7a8.16 8.16 0 004.77 1.52v-3.4a4.85 4.85 0 01-1.04-.1z"/></svg></div>
                            <input type="text" id="soc-bb-tiktok" class="w-full border border-gray-400 rounded-full px-3 py-1 outline-none text-sm focus:border-black">
                        </div>
                        <div class="flex items-center gap-2">
                            <div class="w-8 h-8 rounded-full bg-red-500 flex items-center justify-center text-white flex-shrink-0"><svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24"><path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/></svg></div>
                            <input type="text" id="soc-bb-email" class="w-full border border-gray-400 rounded-full px-3 py-1 outline-none text-sm focus:border-black">
                        </div>
                    </div>

                    <textarea id="input-bb-details" placeholder="Details ...." rows="5" class="w-full border border-gray-400 rounded-2xl px-4 py-3 outline-none focus:border-black mt-4"></textarea>
                </div>

                <div class="section-header">Video</div>
                <div class="flex items-center gap-4 mb-8">
                    <input type="text" id="input-bb-video" placeholder="Link to your Video / Youtube / Vimeo" class="w-full border border-gray-400 rounded-full px-4 py-2 outline-none focus:border-black">
                    <button class="bg-brandYellow text-black px-8 py-2 rounded-full font-bold hover:bg-yellow-500 transition shadow">Add</button>
                </div>

                <div class="mt-12 pt-6 border-t border-gray-300 flex justify-between items-center">
                    <button id="btn-delete-bigband" onclick="deleteBigband()" class="hidden text-red-500 border border-red-500 px-6 py-2 rounded-full font-bold hover:bg-red-500 hover:text-white transition shadow">Delete Profile</button>
                    <button onclick="saveBigband()" class="bg-black text-white px-10 py-3 rounded-full font-bold text-lg hover:bg-gray-800 transition shadow-lg ml-auto">Save Profile</button>
                </div>
            </div>
        </div>

    </main>

    <script>
        // ==============================================
        // 1. ระบบจัดการ View และ Sidebar
        // ==============================================
        function switchMainView(viewId) {
            const views = ['festival', 'musician', 'courses', 'bigband'];
            
            // รีเซ็ตการแสดงผล View หลัก
            views.forEach(v => {
                document.getElementById('view-' + v).classList.add('hidden');
            });
            document.getElementById('view-' + viewId).classList.remove('hidden');

            // รีเซ็ตสี Sidebar ทั้งหมดให้กลับเป็นค่าเริ่มต้น (โปร่งใส + ตัวหนังสือสีดำ)
            document.getElementById('nav-festival-bg').className = 'transition-colors';
            document.getElementById('nav-festival-text').className = 'font-bold text-black py-3 px-6 block hover:opacity-80 transition';
            
            document.getElementById('nav-musician-bg').className = 'transition-colors mt-2';
            document.getElementById('nav-musician-text').className = 'font-bold text-black py-3 px-6 block hover:opacity-80 transition';
            document.getElementById('musician-sub-nav').classList.add('hidden'); // ซ่อนซับเมนู
            
            document.getElementById('nav-courses-bg').className = 'transition-colors mt-2';
            document.getElementById('nav-courses-text').className = 'font-bold text-black py-3 px-6 block hover:opacity-80 transition';
            
            document.getElementById('nav-bigband-bg').className = 'transition-colors mt-2';
            document.getElementById('nav-bigband-text').className = 'font-bold text-black py-3 px-6 block hover:opacity-80 transition';

            // นำสีของ Theme ประจำแต่ละหมวดหมู่มาใส่ให้เมนูที่ถูกกด
            if (viewId === 'festival') {
                document.getElementById('nav-festival-bg').classList.add('bg-brandBlue');
                document.getElementById('nav-festival-text').classList.replace('text-black', 'text-white');
            } 
            else if (viewId === 'musician') {
                document.getElementById('nav-musician-bg').classList.add('bg-brandYellow');
                document.getElementById('musician-sub-nav').classList.remove('hidden'); // โชว์ Artist/Jazz
            } 
            else if (viewId === 'courses') {
                document.getElementById('nav-courses-bg').classList.add('bg-brandGreen');
                document.getElementById('nav-courses-text').classList.replace('text-black', 'text-white');
            } 
            else if (viewId === 'bigband') {
                document.getElementById('nav-bigband-bg').classList.add('bg-brandGrey');
            }
        }

        function previewImage(event, previewId, textId) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const img = document.getElementById(previewId);
                    img.src = e.target.result;
                    img.classList.remove('hidden');
                    document.getElementById(textId).classList.add('hidden');
                }
                reader.readAsDataURL(file);
            }
        }
        function clearImagePreview(previewId, textId) {
            document.getElementById(previewId).classList.add('hidden');
            document.getElementById(previewId).src = "";
            document.getElementById(textId).classList.remove('hidden');
        }

        // ==============================================
        // 2. ระบบจำลองฐานข้อมูลของแตละหมวด
        // ==============================================
        let eventsDatabase = []; let currentEventId = null;
        let musicianDatabase = []; let currentMusicianId = null;
        
        // --- COURSES LIBRARY ---
        let coursesDatabase = [];
        let currentCourseId = null;

        function createNewCourse() {
            currentCourseId = null;
            document.getElementById('header-title-courses').innerText = "Courses Library";
            document.getElementById('btn-delete-course').classList.add('hidden');
            
            document.getElementById('input-course-title').value = '';
            document.getElementById('input-course-creator').value = '';
            document.getElementById('input-course-details').value = '';
            clearImagePreview('preview-course-banner', 'text-course-banner');

            updateCourseSidebar();
        }

        function saveCourse() {
            const titleInput = document.getElementById('input-course-title').value;
            if (!titleInput.trim()) { alert('กรุณากรอกชื่อคอร์สก่อนครับ'); return; }

            const data = {
                title: titleInput,
                creator: document.getElementById('input-course-creator').value,
                details: document.getElementById('input-course-details').value
            };

            if (currentCourseId === null) {
                data.id = 'crs_' + Date.now();
                coursesDatabase.push(data);
                currentCourseId = data.id;
                alert('สร้างคอร์สสำเร็จ!');
            } else {
                const index = coursesDatabase.findIndex(c => c.id === currentCourseId);
                if (index !== -1) { data.id = currentCourseId; coursesDatabase[index] = data; alert('อัปเดตสำเร็จ!'); }
            }

            updateCourseSidebar();
            document.getElementById('header-title-courses').innerText = "Edit: " + titleInput;
            document.getElementById('btn-delete-course').classList.remove('hidden');
        }

        function loadCourse(id) {
            const c = coursesDatabase.find(x => x.id === id);
            if (!c) return;
            currentCourseId = id;
            document.getElementById('header-title-courses').innerText = "Edit: " + c.title;
            document.getElementById('btn-delete-course').classList.remove('hidden');
            
            document.getElementById('input-course-title').value = c.title || '';
            document.getElementById('input-course-creator').value = c.creator || '';
            document.getElementById('input-course-details').value = c.details || '';

            switchMainView('courses');
            updateCourseSidebar();
        }

        function deleteCourse() {
            if(currentCourseId === null) return;
            if (confirm("ลบคอร์สนี้หรือไม่?")) {
                coursesDatabase = coursesDatabase.filter(c => c.id !== currentCourseId);
                createNewCourse();
            }
        }

        function updateCourseSidebar() {
            const list = document.getElementById('courses-list');
            list.innerHTML = '';
            if (coursesDatabase.length === 0) { list.classList.add('hidden'); return; }
            list.classList.remove('hidden');
            
            coursesDatabase.forEach(c => {
                const link = document.createElement('a');
                link.href = "#";
                link.className = `block px-2 py-1 rounded transition ${c.id === currentCourseId ? 'text-brandGreen font-bold bg-green-50' : 'hover:text-brandGreen hover:bg-gray-100'}`;
                link.innerText = "• " + c.title;
                link.onclick = (e) => { e.preventDefault(); loadCourse(c.id); };
                list.appendChild(link);
            });
        }

        // --- CMBIGBAND ---
        let bigbandDatabase = [];
        let currentBigbandId = null;

        function createNewBigband() {
            currentBigbandId = null;
            document.getElementById('header-title-bigband').innerText = "CMBigband";
            document.getElementById('btn-delete-bigband').classList.add('hidden');
            
            document.getElementById('input-bb-title').value = '';
            document.getElementById('input-bb-genre').value = '';
            document.getElementById('input-bb-details').value = '';
            document.getElementById('input-bb-video').value = '';
            document.getElementById('soc-bb-fb').value = '';
            document.getElementById('soc-bb-wa').value = '';
            document.getElementById('soc-bb-ig').value = '';
            document.getElementById('soc-bb-web').value = '';
            document.getElementById('soc-bb-tiktok').value = '';
            document.getElementById('soc-bb-email').value = '';

            clearImagePreview('preview-bb-banner', 'text-bb-banner');
            clearImagePreview('preview-bb-profile', 'text-bb-profile');

            updateBigbandSidebar();
        }

        function saveBigband() {
            const titleInput = document.getElementById('input-bb-title').value;
            if (!titleInput.trim()) { alert('กรุณากรอกชื่อวงก่อนครับ'); return; }

            const data = {
                title: titleInput,
                genre: document.getElementById('input-bb-genre').value,
                details: document.getElementById('input-bb-details').value
            };

            if (currentBigbandId === null) {
                data.id = 'bb_' + Date.now();
                bigbandDatabase.push(data);
                currentBigbandId = data.id;
                alert('สร้างโปรไฟล์ Bigband สำเร็จ!');
            } else {
                const index = bigbandDatabase.findIndex(b => b.id === currentBigbandId);
                if (index !== -1) { data.id = currentBigbandId; bigbandDatabase[index] = data; alert('อัปเดตสำเร็จ!'); }
            }

            updateBigbandSidebar();
            document.getElementById('header-title-bigband').innerText = "Edit: " + titleInput;
            document.getElementById('btn-delete-bigband').classList.remove('hidden');
        }

        function loadBigband(id) {
            const b = bigbandDatabase.find(x => x.id === id);
            if (!b) return;
            currentBigbandId = id;
            document.getElementById('header-title-bigband').innerText = "Edit: " + b.title;
            document.getElementById('btn-delete-bigband').classList.remove('hidden');
            
            document.getElementById('input-bb-title').value = b.title || '';
            document.getElementById('input-bb-genre').value = b.genre || '';
            document.getElementById('input-bb-details').value = b.details || '';

            switchMainView('bigband');
            updateBigbandSidebar();
        }

        function deleteBigband() {
            if(currentBigbandId === null) return;
            if (confirm("ลบโปรไฟล์นี้หรือไม่?")) {
                bigbandDatabase = bigbandDatabase.filter(b => b.id !== currentBigbandId);
                createNewBigband();
            }
        }

        function updateBigbandSidebar() {
            const list = document.getElementById('bigband-list');
            list.innerHTML = '';
            if (bigbandDatabase.length === 0) { list.classList.add('hidden'); return; }
            list.classList.remove('hidden');
            
            bigbandDatabase.forEach(b => {
                const link = document.createElement('a');
                link.href = "#";
                link.className = `block px-2 py-1 rounded transition ${b.id === currentBigbandId ? 'font-bold bg-gray-200' : 'hover:bg-gray-100'}`;
                link.innerText = "• " + b.title;
                link.onclick = (e) => { e.preventDefault(); loadBigband(b.id); };
                list.appendChild(link);
            });
        }

        // --- Mock functions for Festival & Musician to avoid errors ---
        function createNewEvent() { alert("โค้ดทำงานเหมือนเวอร์ชันก่อนหน้าครับ"); }
        function saveEvent() { alert("โค้ดทำงานเหมือนเวอร์ชันก่อนหน้าครับ"); }
        function deleteEvent() { }
        function createNewMusician() { alert("โค้ดทำงานเหมือนเวอร์ชันก่อนหน้าครับ"); }
        function saveMusician() { alert("โค้ดทำงานเหมือนเวอร์ชันก่อนหน้าครับ"); }
        function deleteMusician() { }

    </script>
</body>
</html>